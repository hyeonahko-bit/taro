<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>íƒ€ë¡œ Yes/No</title>
    <link rel="stylesheet" href="style.css" />
    <!-- Google Tag Manager -->
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0];
        var j = d.createElement(s);
        var dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-MZN3MQ2J");
    </script>
    <!-- End Google Tag Manager -->
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
      <iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-MZN3MQ2J"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div class="app">
      <header class="top">
        <div class="badge">TARO</div>
        <h1>ì˜¤ëŠ˜ì˜ ì§ˆë¬¸ì— ë‹µì„ ë“œë¦´ê²Œìš”</h1>
        <p class="sub">ê³ ë¯¼ì„ ê¹Šì´ ìƒê°í•˜ê³  ë©”ì´ì € 22ì¥ ì¤‘ 1ì¥ì„ ì„ íƒí•˜ì„¸ìš”. ê³ ë¯¼ì— ëŒ€í•œ ë‹µì„ Yes/Noë¡œ ì•Œë ¤ë“œë ¤ìš”.</p>
        <p class="sub" id="visitorCount" aria-live="polite">ë°©ë¬¸ì ìˆ˜ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
      </header>

      <section class="guide">
        <div class="guide-card">
          <div class="guide-title">ì› ì¹´ë“œ ìŠ¤í”„ë ˆë“œ</div>
          <p class="guide-desc">
            í•œ ì¥ì„ ë½‘ì•„ í˜„ì¬ ìƒí™©ì´ë‚˜ ì§ˆë¬¸ì— ëŒ€í•œ ê°„ë‹¨í•œ ë‹µì„ ì–»ì–´ìš”.
          </p>
          <div class="guide-tag">í•˜ë£¨ ìš´ì„¸ Â· ì§§ì€ ì¡°ì–¸</div>
        </div>
        <div class="guide-card">
          <div class="guide-title">í•´ì„ íŒ</div>
          <p class="guide-desc">
            ìƒì§•, ìƒ‰, ì¸ë¬¼ì˜ í‘œì •ê³¼ ìì„¸ë¥¼ ê´€ì°°í•˜ê³  ë– ì˜¤ë¥´ëŠ” ì§ê´€ì„ ì ì–´ë³´ì„¸ìš”.
          </p>
          <div class="guide-tag">ìƒì§• ì½ê¸° Â· ê¸°ë³¸ ì˜ë¯¸ Â· ì§ê´€</div>
        </div>
      </section>

      <section class="card-area">
        <div class="hint">ì¹´ë“œë¥¼ íƒ­í•´ ì„ íƒí•˜ì„¸ìš”</div>
        <div class="card-grid" id="cardGrid" aria-live="polite"></div>
      </section>

      <div class="reset-bar" id="resetBar">
        <div class="reset-text">ì„ íƒí•œ ì¹´ë“œë¥¼ ë‹¤ì‹œ ë½‘ì„ê¹Œìš”?</div>
        <button class="reset" id="resetFloatingBtn" type="button">ë‹¤ì‹œ ë³´ê¸°</button>
      </div>

      <div class="modal" id="resultModal" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="modal-backdrop" data-close="true"></div>
        <div class="modal-panel">
          <div class="modal-header">
            <div class="result-label">ë‹µë³€</div>
            <button class="modal-close" id="closeBtn" type="button" aria-label="ë‹«ê¸°">
              âœ•
            </button>
          </div>
          <div class="result-answer">
            <div class="result-value" id="resultValue">-</div>
            <div class="result-note" id="resultNote">ì¹´ë“œë¥¼ ì„ íƒí•˜ë©´ ê²°ê³¼ê°€ ë³´ì—¬ìš”.</div>
          </div>
          <div class="result-card" id="resultCard">
            <div class="result-empty">ì„ íƒëœ ì¹´ë“œê°€ ì—†ì–´ìš”</div>
          </div>
          <div class="result-options" id="resultOptions">
            <div class="option-group">
              <div class="option-title">í•´ì„ ê¹Šì´</div>
              <div class="option-grid">
                <button class="option-chip is-active" type="button" data-depth="simple">ğŸŒ¿ ê°„ë‹¨</button>
                <button class="option-chip" type="button" data-depth="detail">ğŸ“š ìì„¸íˆ</button>
              </div>
            </div>
            <div class="option-group">
              <div class="option-title">í†¤</div>
              <div class="option-grid">
                <button class="option-chip" type="button" data-tone="positive">âœ¨ ê¸ì •</button>
                <button class="option-chip is-active" type="button" data-tone="neutral">ğŸ§­ ì¤‘ë¦½</button>
                <button class="option-chip" type="button" data-tone="warning">âš ï¸ ê²½ê³ </button>
              </div>
            </div>
          </div>
          <div class="result-interpretation" id="resultInterpretation">
            <div class="interpret-title">í•´ì„</div>
            <p class="interpret-text" id="interpretText">ì¹´ë“œë¥¼ ì„ íƒí•˜ë©´ í•´ì„ì´ ë³´ì—¬ìš”.</p>
            <div class="interpret-tags" id="interpretTags"></div>
          </div>
          <div class="result-advice" id="resultAdvice">í•œ ì¤„ ì¡°ì–¸ì´ ì—¬ê¸°ì— í‘œì‹œë¼ìš”.</div>
          <div class="result-tools">
            <button class="reset" id="resetBtn" type="button">ë‹¤ì‹œ ë³´ê¸°</button>
            <button class="share" id="shareBtn" type="button">ê²°ê³¼ ê³µìœ </button>
            <span class="share-note" id="shareNote" aria-live="polite"></span>
          </div>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
    <script>
      (function () {
        var el = document.getElementById("visitorCount");
        if (!el) return;

        var namespace = "tarot-yes-no";
        var key = "visitors";
        var fallbackKey = namespace + "-" + key;

        var endpoints = [
          "https://api.countapi.xyz/hit/" + namespace + "/" + key,
          "https://countapi.mileshilliard.com/api/v1/hit/" + fallbackKey
        ];

        function getValue(data) {
          if (!data) return null;
          if (typeof data.value === "number") return data.value;
          if (typeof data.count === "number") return data.count;
          if (typeof data.hits === "number") return data.hits;
          return null;
        }

        function tryFetch(index) {
          if (index >= endpoints.length) {
            el.textContent = "ë°©ë¬¸ì ìˆ˜ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆì–´ìš”.";
            return;
          }

          fetch(endpoints[index])
            .then(function (res) {
              if (!res.ok) {
                throw new Error("bad status");
              }
              return res.json();
            })
            .then(function (data) {
              var value = getValue(data);
              if (typeof value !== "number") {
                throw new Error("invalid response");
              }
              el.textContent = "ì „ì²´ ë°©ë¬¸ì ìˆ˜: " + value.toLocaleString();
            })
            .catch(function () {
              tryFetch(index + 1);
            });
        }

        tryFetch(0);
      })();
    </script>
  </body>
</html>
